<h3><b>Buy page</b></h3>
<div ng-if="purc.selectedPurchaser.length == 0">
  <h4>All registered users:</h4>
  <label ng-if="purc.allUsers.length > 1" for="input"> Search: <input ng-model="purc.searchText" placeholder="Customer name"></label>
  <table ng-if="purc.allUsers.length" class = "table table-striped table-bordered table-hover">
    <thead>
      <tr class = "info">
        <th>Customer Name</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat = "user in purc.allUsers | filter:purc.searchText">
        <td>{{ user.name }}</td>
        <td>
          <a ng-if="purc.allUsers.length > 1" ng-click="purc.selectOne(user.dni)">Purchase</a> -
          <a ng-if="purc.allUsers.length > 1" ng-click="purc.viewPurchase(user.dni)">Review purchase</a>
          <a ng-if="purc.allUsers.length == 1" ng-click="purc.loadAllUsers()">Cancel purchase</a>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div ng-if="purc.selectedPurchaser.length == 1">
  <h4>Registered customer</h4>
  <h4>
    Name: {{purc.selectedPurchaser[0].name}} - Dni: {{purc.selectedPurchaser[0].dni}}
  </h4>
  <!-- <br> -->
  <h4>Furniture purchased:</h4>
  <br>
  <table ng-if="purc.products.length" class = "table table-striped table-bordered table-hover">
    <thead>
      <tr class = "info">
        <th>Date</th>
        <th>Products</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat = "product in purc.products">
        <td>{{ product.purchasedAt }}</td>
        <td>
          <li ng-repeat="order in product.productOrders">
              {{order.prodId}}
          </li>
        </td>
      </tr>
    </tbody>
  </table>
  <a ng-click="purc.loadAllUsers()">Cancel</a>
</div>

<hr>
<div ng-if="purc.allUsers.length == 1">
  <h4><b>Products to buy: </b></h4>
  <label ng-if="purc.allProducts.length > 1" for="input"> Search: <input ng-model="purc.searchProduct" placeholder="Product name"></label>
  <div class = "form-group">
    <label for = "date"> Date:  </label>
    <input type = "date" id = "date" class = "form-control" ng-model = "purc.purchaseDate" required>
  </div>
  <table ng-if="purc.allProducts.length" class = "table table-striped table-bordered table-hover">
    <thead>
      <tr class = "info">
        <th>Name</th>
        <th>Model</th>
        <th>Purchase</th>
        <!-- <th ng-if="!ifSearchUser">Action</th> -->
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat = "product in purc.allProducts | filter:purc.searchProduct">
        <td>{{ product.name }}</td>
        <td>{{ product.model }}</td>
        <td>
          <input type="checkbox" value="{{product.id}}"
          ng-click="purc.ProductToBuy(product)" ng-model="purc.selectedList[product.id]"/>
          <label ng-if="purc.selectedList[product.id]" for="input">
            Amount: <input id="number" type="number" value="1" ng-model="purc.amountList[product.id]" />
          </label>
        </td>
      </tr>
    </tbody>
  </table>
  <a ng-click="purc.CommitPurchase()" role = "button" class = "btn btn-info">Buy</a>
</div>
